<ng-container *transloco="let t">
<div class="host" *ngIf="userService.currentUser; else noUser">
<ng-container *ngIf="userService.data; let data">
<ng-container *ngIf="userService.publicData; let publicData">

  <div class="head">

    <div class="cover">
      <nguix-account-cover
        [uid]="data.uid"
        [images]="publicData.images"
      ></nguix-account-cover>
    </div>

    <div class="content">
      <div class="avatar">
        <nguix-account-avatar
          [uid]="data.uid"
          [displayName]="publicData.title"
          [thumbnails]="publicData.thumbnails"
        ></nguix-account-avatar>
      </div>
      <div class="info">
        <h3 class="name">
          <strong class="truncate">{{ publicData.title }}</strong>
          <button class="edit button-clear" (click)="updateDisplayName()">
            <nguix-icon name="pencil-square" size="16"></nguix-icon>
          </button>
        </h3>
        <div class="email">
          <em>{{ data.email }}</em>
          <a *ngIf="!data.emailVerified" href="#" (click)="verifyEmail();false;">Verify Email</a>
        </div>
      </div>
      <div class="public" *ngIf="data.username">
        <button class="button-primary" (click)="openPublicProfile()">View Public Profile</button>
      </div>
    </div>

  </div>

  <div class="body">

    <ul class="general">
      <li class="title">General</li>

      <li class="publicity">
        <div class="label">Profile {{ publicData.status==='publish' ? 'Is' : 'Is Not'}} Public</div>
        <div class="value">
          <label class="form-switch">
            <input
              type="checkbox"
              [checked]="publicData.status==='publish'"
              (change)="updatePublicity($event)"
            />
            <span class="slider"></span>
          </label>
        </div>
      </li>

      <li class="username">
        <nguix-account-text-editor
          [i18n]="i18n"
          label="Username"
          type="text"
          [value]="data.username"
          [editable]="false"
        ></nguix-account-text-editor>
      </li>

      <li class="email">
        <nguix-account-text-editor
          [i18n]="i18n"
          label="Email"
          type="email"
          [value]="data.email"
          [editable]="false"
          [showPubliclyToggler]="true"
          [isPublicly]="!!data.publicly?.email"
          (publiclyChanged)="updateEmailPublicly($event)"
        ></nguix-account-text-editor>
      </li>

      <li class="intro">
        <nguix-account-text-editor
          [i18n]="i18n"
          label="Intro"
          type="text"
          [value]="data.intro"
          (save)="updateIntro($event)"
        ></nguix-account-text-editor>
      </li>

    </ul>

  </div>
  
  <div class="foot">
    <button class="button-outline" (click)="signOut()">{{ !i18n ? logoutText : t('NGUIX_ACCOUNT.LOGOUT_TEXT') || logoutText }}</button>
  </div>

</ng-container>
</ng-container>
</div>

<ng-template #noUser>
  <p>No signed in user, <a [usefulRouterLink]="['login']">login here</a>!</p>
</ng-template>

</ng-container>
